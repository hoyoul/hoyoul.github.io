<!DOCTYPE html>
<html>
  <head><title>org publishing에 관해</title>


<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes" />

<link rel="shortcut icon" href="./images/favicon.ico" type="image/x-icon">
<link rel="icon" href="./images/favicon.ico" type="image/x-icon">    

<link rel="stylesheet" href="/css/main.css">

</head>
  <body><header>
  <a href="/" id="logo">
    <img src="http://braindump.frege2godel.me/images/mylogo.png" alt="holy frege">
    <h3><span>H</span>oly <span>F</span>rege's <span id="note">notes</span></h3>
  </a>
    <small>G.frege를 너무 사랑하는 holy가...</small>  
</header>

<div class="container">
  <div class="page">
    <h1 class="collapsed-title">org publishing에 관해</h1>    
      <div class="content">
	<a href="http://braindump.frege2godel.me/posts/20220422113228-org_publishing%E1%84%8B%E1%85%A6_%E1%84%80%E1%85%AA%E1%86%AB%E1%84%92%E1%85%A2/" alt="org publishing에 관해" class="permalink"><h1>org publishing에 관해</h1></a>      
	<h2 id="org-publishing이란">org publishing이란?</h2>
<ul>
<li>참고:<a href="https://orgmode.org/manual/Publishing.html#Publishing">https://orgmode.org/manual/Publishing.html#Publishing</a></li>
<li>org에는 publishing management system 기능이 있다. 이것은 org파일이
서로 연결되어 있는 project를 html으로 export할 수 있게 한다. 또한
이렇게 export된 html과 attached file을 server로 upload도 할 수 있다.
물론 pdf로 export하고, 이를 server에 올릴 수도 있다. 즉 org파일을
html으로 export하고 webserver로 upload하는 것을 publishing이라고 한다.</li>
</ul>
<h2 id="configurations">Configurations</h2>
<h3 id="project-alist">Project alist</h3>
<ul>
<li>우선 project를 정의해야 한다. project는 publish할 org 파일이 어디에
있는지, 그리고 어디에 upload할것인지, 어떤 처리를 할건지, html로
export할지, pdf로 할지&hellip;css는 어떻게 할지? 이런 모든 설정을 이
org-publish-project-alist에서 기술한다. project이름을 만들고, 그에
해당하는 property를 기술하면 된다. property는 다음 section부터 기술
된다. 그런데 이렇게 포맷만 보고서는 정확히 어떻게 기술해야 하는지
감은 안 올 수 있다. 나중에 완성된 형태를 보면 이해가 될 것이다.</li>
<li>org-publish-project-alist 변수: 2가지 설정 방식이 있다.
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>(&#34;project-name&#34; :property value :property value ...)
</span></span></code></pre></div></li>
</ul>
<p>아래 설정은 좀 다르다. project안에 또 다른 project가 있는 것이다. sub
project를 기술 했는데, 예를들어, A폴더안에 B폴더는 pdf로 변환해서
다른위치에 놓을것이다. 라면, 이렇게 sub project를 기술해야 한다.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>(&#34;project-name&#34; :components (&#34;project-name&#34; &#34;project-name&#34; ...))
</span></span></code></pre></div><h3 id="sources-and-destination-for-files">Sources and Destination for files</h3>
<ul>
<li>(:base-directory): org 파일이 모아진 directory로 보면 된다.</li>
<li>(:publishing-directory): publish된 파일(html,pdf,etc)들이 있는
directory. web server의 특정위치를 기술해서 직접 upload할 수도 있고,
그냥 local directory로 설정하고 upload는 개발자가 알아서 올릴 수도 있다.</li>
<li>(:preparation-function): 본격적으로 publishing process를 진행하기
앞서서 미리 진행할 함수, 함수들을 여기에 기술하면 먼저 실행된다.</li>
<li>(:completion-function): publishing process를 끝마치고나서 해야할
것들, 예를들면, file permission변경 같은 것을 여기에 기술한다.</li>
</ul>
<h3 id="selecting-files">Selecting files</h3>
<ul>
<li>위에서 :base-directory라는 속성으로 publishing할 폴더를 정했다면,
기본적으로 그 폴더의 org파일들이 publishing process를 거치게 된다.
근데, 그 폴더에서 특정파일은 제외한다거나, 특정파일은 반드시
포함하거나, sub folder는 처리하지 않는다거나 하는 처리를 할 수 있다.
이런 처리는 regular expression으로 나타낸다.</li>
<li>(:base-extension): 처리될 확장자를 기술한다. 만일 any라고 하면, 모든
파일이 publishing process의 처리대상이된다.</li>
<li>(:exclude): publishing 처리에 배제되어야 하는 파일들을 regular
expression으로 기술 한다.</li>
<li>(:include): 반드시 포함되어야 하는 파일을 나열한다.</li>
<li>(:recursive): non-nil이면 subdirectory도 publishing 처리를 한다.</li>
</ul>
<h3 id="publishing-action">publishing action</h3>
<ul>
<li>publishing이란것은 source directory의 selecting file들을 처리해서
publishing directory로 처리하는게 전부다.</li>
<li>(org-html-publish-to-html function): 이 함수는 org파일을 html로
변경하는 함수다.</li>
<li>(org-latex-publish-to-pdf function): 이 함수는 org파일을 pdf로
변경하는 함수다.</li>
<li>(org-org-publish-to-org function): 이 함수는 org파일을 org파일로
변경하는 함수다. 좀 이상할 수 있지만, tag나 comment가 제거된
형태라고 한다. 이 제거된 org파일을 html로 변경하려면,
:htmlized-source를 t로 설정하면 &lsquo;file.org.html&rsquo;형태로 바뀐다.</li>
<li>(org-publish-attachment function): image와 같이 변경은 필요 없고,
destination directory로 이동만 하는 경우에는 이 함수를 사용한다.</li>
<li>org파일은 아니고, image와 같은 파일이 아닌경우, 특정처리를
해야한다면, 다음과 같은 속성을 정의해야 한다. :publishing-function,
:htmlized-source라는 속성을 설정해서 처리해야 한다.</li>
</ul>
<h3 id="publishing-options">publishing options</h3>
<ul>
<li>org file을 html로 변경하거나 latex로 변경할 때, 즉 위에서 말한
org-html-publish-to-html이나, org-latex-publish-to-html function을
호출하는데, 이 함수들은 내부적으로 html, latex exporters라는
프로그램을 실행한다. 이런 exporter가 org를 html이나 latex로
converting할 때, 기본설정값을 가지고 converting한다. 이런 설정값들은
우리가 변경할 수 도 있다. 엄청나게 많은 설정값들이 있는데, 아래
link를 참조해야 한다.</li>
<li>참조:<a href="https://orgmode.org/manual/Publishing-options.html">https://orgmode.org/manual/Publishing-options.html</a></li>
</ul>
<h3 id="publishing-links">Publishing links</h3>
<ul>
<li>org파일들은 서로 다른 org 파일을 link로 참조하고 있는데, html이나,
latex로 변경할 때 이런 link에 대한 처리는 자동으로 된다. 예를
들어서, A라는 org파일에서  [[<a href=""></a>[the foo]]] 라고 참조했을 때,
publishing이 끝나면, file은 html로 변경되고, org확장자는 html로
변경되며, link도 그에 맞게 변경된다.</li>
</ul>
<h3 id="site-map">site map</h3>
<ul>
<li>publishing이 끝나면, project의 file들에 관한 site map page를 만드는
것 같다. 모든 link를 list로 표현한 file같은데,이것에 대한 control
option들을 보여준다. 참고하자.</li>
<li>참조:<a href="https://orgmode.org/manual/Site-map.html">https://orgmode.org/manual/Site-map.html</a></li>
</ul>
<h3 id="generating-an-index">Generating an index</h3>
<ul>
<li>project를 publishing하면, index file이 만들어진다. :makeindex라는
속성이 non-nil라고 가정하자. 그러면, theindex.org라는 목차파일이
만들어지고, 이 org파일이 html로 publishing되었다면, theindex.html이
만들어진다. publishing할 때, 만들어지는 목차파일을 보면, #+INCLUDE:
&ldquo;theindex.inc&quot;라는 문장이 있다. theindex.inc파일을 보면, INDEX라는
keyword로 index entry를 표현하고 있다. 정확하게 어떻게 동작하고
처리되는지는 직접 동작시켜서 확인해야 알 수 있을 듯 하다.</li>
</ul>
<h2 id="uploading-files">Uploading Files</h2>
<ul>
<li>
<p>publishing과정이라는게 변환과정 + uploading과정이다. 여기서
uploading을 할때, 2가지 방식이 있다. 첫번째는 Rsync나 Unison이라는
third party tool이 있어서, 이것을 이용하는 방법. 두번째로
emacs내장기능인 tramp를 사용하는 것이다. tramp를 사용해서 remote에
있는 server로 published된 html이나, pdf를 전송하는 방식인데, 이것은
문제가 heavy usage에 문제가 있다고 알려져 있다. 근데, 단순히
uploading만 하는게 아니라, 동기화기능도 같이 처리한다. local에
저장된 파일과 server에 저장된 파일이 일치하지 않을때
uploading한다거나, local에는 있는데, server에 없을 때 uploading하는,
동기화작업도 수행한다.</p>
</li>
<li>
<p>Rsync와 Unison의 좋은점은 동기화 처리를 할 수 있다는 것이다.
timestamp를 사용해서 비교후에 uploading을 한다. 그래서, 보통, 변환한
파일을 local로 published 하고, 동기화작업을 Rsync와 Unison을 사용하는
방식을 많이 사용한다. 속도도 빠르다고 한다.</p>
</li>
</ul>
<h2 id="sample-configuration">Sample Configuration</h2>
<ul>
<li>simple example은 component가 1개인 project의 처리고, complex
Example은 component가 1개 이상일 경우의 처리다.</li>
</ul>
<h3 id="simple-example">Simple Example</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>(setq org-publish-project-alist
</span></span><span style="display:flex;"><span>      &#39;((&#34;org&#34;
</span></span><span style="display:flex;"><span>         :base-directory &#34;~/org/&#34;
</span></span><span style="display:flex;"><span>         :publishing-function org-html-publish-to-html
</span></span><span style="display:flex;"><span>         :publishing-directory &#34;~/public_html&#34;
</span></span><span style="display:flex;"><span>         :section-numbers nil
</span></span><span style="display:flex;"><span>         :with-toc nil
</span></span><span style="display:flex;"><span>         :html-head &#34;&lt;link rel=\&#34;stylesheet\&#34;
</span></span><span style="display:flex;"><span>                    href=\&#34;../other/mystyle.css\&#34;
</span></span><span style="display:flex;"><span>                    type=\&#34;text/css\&#34;/&gt;&#34;)))
</span></span></code></pre></div><ul>
<li>project이름은 org고, ~/org/ 아래에 있는 모든 org file들을 html로
변환해서 ~/public_html로 이동시킨다. html exporter에게
section-number는 nil로 하고, toc(table of contents)는 표시하지 말고,
html header에 css파일경로를 말해주고 있다.</li>
<li>보면 알겠지만, 이것은 local file을 local에 publish할 뿐,
image라던가, 다른 파일에 대한 설정은 없다.</li>
</ul>
<h3 id="complex-example">Complex Example</h3>
<ul>
<li>이번에는 좀더 복잡하다. org파일에 대한 처리, image에 대한 처리,
css에 대한 처리를 3개의 component에 설정하고, remote에 파일을
전송하는것까지 예를 들어본다.
<div class="highlight"><pre tabindex="0" style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>(setq org-publish-project-alist
</span></span><span style="display:flex;"><span>      &#39;((&#34;orgfiles&#34;
</span></span><span style="display:flex;"><span>         :base-directory &#34;~/org/&#34;
</span></span><span style="display:flex;"><span>         :base-extension &#34;org&#34;
</span></span><span style="display:flex;"><span>         :publishing-directory &#34;/ssh:user@host:~/html/notebook/&#34;
</span></span><span style="display:flex;"><span>         :publishing-function org-html-publish-to-html
</span></span><span style="display:flex;"><span>         :exclude &#34;PrivatePage.org&#34; ;; regexp
</span></span><span style="display:flex;"><span>         :headline-levels 3
</span></span><span style="display:flex;"><span>         :section-numbers nil
</span></span><span style="display:flex;"><span>         :with-toc nil
</span></span><span style="display:flex;"><span>         :html-head &#34;&lt;link rel=\&#34;stylesheet\&#34;
</span></span><span style="display:flex;"><span>                  href=\&#34;../other/mystyle.css\&#34; type=\&#34;text/css\&#34;/&gt;&#34;
</span></span><span style="display:flex;"><span>         :html-preamble t)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        (&#34;images&#34;
</span></span><span style="display:flex;"><span>         :base-directory &#34;~/images/&#34;
</span></span><span style="display:flex;"><span>         :base-extension &#34;jpg\\|gif\\|png&#34;
</span></span><span style="display:flex;"><span>         :publishing-directory &#34;/ssh:user@host:~/html/images/&#34;
</span></span><span style="display:flex;"><span>         :publishing-function org-publish-attachment)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        (&#34;other&#34;
</span></span><span style="display:flex;"><span>         :base-directory &#34;~/other/&#34;
</span></span><span style="display:flex;"><span>         :base-extension &#34;css\\|el&#34;
</span></span><span style="display:flex;"><span>         :publishing-directory &#34;/ssh:user@host:~/html/other/&#34;
</span></span><span style="display:flex;"><span>         :publishing-function org-publish-attachment)
</span></span><span style="display:flex;"><span>        (&#34;website&#34; :components (&#34;orgfiles&#34; &#34;images&#34; &#34;other&#34;))))
</span></span></code></pre></div></li>
<li>orgfiles, images, other라는 세개의 component로 구성되어 있다.
publishing-directory는 원격주소로 되어 있다.</li>
</ul>
<h2 id="triggering-publication">Triggering Publication</h2>
<ul>
<li>위와같이 project를 설정하게 되면, org-exporter interface를 사용해서
project를 publish 할 수 있다.</li>
<li>C-c C-e를 누르면 org-export-dispatch interface를 볼 수 있다. 여기서
우리가 만든 project를 publish할 수 있는 명령어를 제공한다.</li>
<li>C-c C-e P에 있는 모든 명령어를 사용해 보면 된다.</li>
</ul>
<h2 id="참조-사이트">참조 사이트</h2>
<ul>
<li><a href="https://orgmode.org/worg/org-tutorials/org-publish-html-tutorial.html">https://orgmode.org/worg/org-tutorials/org-publish-html-tutorial.html</a></li>
</ul>
      
      </div>
        
  
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
    
     
  

  

  </div>
</div>  
<script src="/js/page.js"></script>
</body>
</html>
